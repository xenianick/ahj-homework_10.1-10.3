!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);function i(e,t,n=""){const i=document.createElement(e);return i.className=t,i.innerHTML+=n,i}const r=[];function d(e,t,n){const d=function(e,t,n){const r=i("div","entry-container"),d=i("div","entry-date",e),o=i("div","entry-content");o.append(t);const a=i("div","entry-location",`[${n}] &#128065;`);return r.appendChild(d),r.appendChild(o),r.appendChild(a),r}(function(e){const t=new Date(e);function n(e){let t=e.toString();return 1===t.length&&(t=`0${t}`),t}let i=t.getFullYear();i=i.toString().substring(2,4);let r=t.getMonth()+1;r=n(r);let d=t.getDate();d=n(d);let o=t.getHours();o=n(o);let a=t.getMinutes();return a=n(a),`${d}.${r}.${i} ${o}:${a}`}(+new Date),e,`${t}`);r.push(d),n.appendChild(d)}function o(e){const t=document.querySelector("body"),n=i("div","popup"),r=i("div","popup-text","<p>Что-то пошло не так.</p><p>Нам не удалось определить ваше местоположение. Пожалуйста, дайте разрешение на использование геолокации или введите координаты вручную.</p><p>Широта и долгота через запятую:</p>"),d=i("form","popup-form"),o=i("input","popup-input"),a=i("button","save-btn form-btn","Сохранить"),c=i("button","reject-btn form-btn","Отмена");c.type="reset",d.appendChild(o),d.appendChild(a),d.appendChild(c),n.appendChild(r),n.appendChild(d);const s=i("div","error-msg-coords","Координаты должны соответствовать формату 51.50851 или −0.12572");d.addEventListener("submit",t=>{if(t.preventDefault(),""===o.value)o.after(s);else{const t=function(e){let t=e;if(!t.includes(" ")){const e=t.slice(0,t.indexOf(",")),n=t.slice(t.indexOf(",")+1);t=`${e}, ${n}`}return t.includes("[")&&t.includes("]")&&(t=t.slice(t.indexOf("[")+1,t.indexOf("]"))),/^[-—–−-]?\d{1,2}\.\d{5}, [-—–−-]?\d{1,2}.\d{5}$/.test(t)?t:null}(o.value);t?(e(t),n.remove()):o.after(s)}}),o.addEventListener("focus",()=>{s.remove()}),c.addEventListener("click",()=>{n.remove()}),t.appendChild(n)}function a(e){navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const{latitude:n,longitude:i}=t.coords;e(`${n.toFixed(5)}, ${i.toFixed(5)}`)},()=>{o(e)}):o(e)}function c(e){const t=document.querySelector("body"),n=i("div","popup"),r=i("div","popup-text",`<p>Что-то пошло не так.</p><p>${e}</p>`),d=i("button","form-btn","Понятно");n.appendChild(r),n.appendChild(d),d.addEventListener("click",()=>{n.remove()}),t.appendChild(n)}const s=i("div","record-container"),l=i("div","done-btn manage-btn","&#10004;"),p=i("div","timer","00:00"),u=i("div","reset-btn manage-btn","&#10008;");let v,f;async function m(){await this.recorder.stop(),this.stream.getTracks().forEach(e=>e.stop()),a(e=>{this.media.controls=!0,d(this.media,e,this.entriesContainer),l.removeEventListener("click",v)})}async function h(){await this.recorder.stop(),this.stream.getTracks().forEach(e=>e.stop()),"video"===this.mediaType&&(this.media.srcObject=null,this.media.classList.remove("preview"),this.media.remove()),u.removeEventListener("click",f)}async function b(e,t,n,r){const d=i(`${e}`,`${e}-record`,`Your browser are not supported ${e}`);if(navigator.mediaDevices)try{let i=!1,o=!1;"audio"===e&&(i=!0),"video"===e&&(o=!0,i=!0);const a=await navigator.mediaDevices.getUserMedia({audio:i,video:o});r.classList.add("hide"),n.appendChild(s);const c=new MediaRecorder(a),b=[];let y;c.addEventListener("start",()=>{y=function(e){const t=e.innerHTML;let n=t.slice(t.indexOf(":")+1),i=t.slice(0,t.indexOf(":"));return n=parseInt(n,10),i=parseInt(i,10),setInterval(()=>{i+=1,i>59&&(n+=1,i=0);let t=`${n}`,r=`${i}`;i<10&&(r=`0${i}`),n<10&&(t=`0${n}`);const d=`${t}:${r}`;e.innerHTML=d},1e3)}(p),"video"===e&&(d.muted=!0,d.classList.add("preview"),d.srcObject=a,d.play(),n.appendChild(d))}),c.addEventListener("dataavailable",t=>{"video"===e&&(d.srcObject=null,d.muted=!1,d.classList.remove("preview"),d.remove()),b.push(t.data)}),c.addEventListener("stop",()=>{const e=new Blob(b);d.src=URL.createObjectURL(e),clearInterval(y),p.innerHTML="00:00",s.remove(),r.classList.remove("hide")}),c.start(),v={handleEvent:m,recorder:c,stream:a,media:d,entriesContainer:t},f={handleEvent:h,recorder:c,stream:a,media:d,mediaType:e},l.addEventListener("click",v),u.addEventListener("click",f)}catch(t){let n;"audio"===e&&(n="микрофону"),"video"===e&&(n="камере"),c(`Доступ к ${n} запрещен. Пожалуйста, измените настройки или дайте разрешение.`)}else c("Ваш браузер не поддерживает запись аудио и видео")}s.appendChild(l),s.appendChild(p),s.appendChild(u);const y=document.querySelector("body"),g=i("div","main-container"),C=i("div","all-entries-container");g.appendChild(C),y.appendChild(g);const L=i("div","entry-input-container"),$=i("textarea","entry-input"),E=i("div","btns-container"),x=i("div","add-voice-btn manage-btn","&#127897;"),O=i("div","add-video-btn manage-btn","&#128249;");L.appendChild($),E.appendChild(x),E.appendChild(O),L.appendChild(E),g.appendChild(L);const w=i("div","error-msg-text","Нужно что-то написать");$.addEventListener("keydown",e=>{if(13===e.keyCode){if(e.preventDefault(),$.addEventListener("focus",()=>{w.remove()}),""===$.value)return $.after(w),void $.blur();const t=i("p","entry-text",$.value);a(e=>{d(t,e,C),$.value="",$.blur()})}}),x.addEventListener("click",()=>{b("audio",C,L,E)}),O.addEventListener("click",()=>{b("video",C,L,E)})}]);